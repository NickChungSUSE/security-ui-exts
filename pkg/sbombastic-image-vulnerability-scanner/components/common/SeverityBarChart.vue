<template>
  <div class="severity-bar-chart">
    <div class="severity-heading">
      <span class="vul-total">{{ total }}</span>
      <span class="vul-desc">vulnerabilities in total</span>
    </div>
    <div class="severity-chart">
      <div v-for="(value, key) in severityData" :key="key" class="severity-item">
        <div class="severity-item-name">{{ key }}</div>
        <PercentageBar :modelValue="percentage(value)" style="width: 314px" />
        <div class="severity-item-value"> {{ value }}</div>
      </div>
    </div>
  </div>
</template>

<script>
import PercentageBar from '@shell/components/PercentageBar.vue';

export default {
  name: 'SeverityBarChart',
  components: {
    PercentageBar,
  },
  props: {
    severityData: {
      type: Object,
      required: true
    }
  },
  methods: {
    percentage(value) {
      return (value / this.total) * 100;
    }
  },
  computed: {
    total() {
      return Object.values(this.severityData).reduce((sum, value) => sum + value, 0);
    },
  }
}
</script>

<style lang="scss" scoped>
  .severity-bar-chart {
    display: flex;
    padding: 8px 0px;
    align-items: flex-start;
    gap: 24px;
    align-self: stretch;

    .severity-heading {
      display: flex;
      width: 160px;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 4px;
      align-self: stretch;

      .vul-total {
        color: #141419;
        font-family: Lato;
        font-size: 24px;
        font-style: normal;
        font-weight: 800;
        line-height: normal;
      }

      .vul-desc {
        color: #6C6C76;
        font-family: Lato;
        font-size: 14px;
        font-style: normal;
        font-weight: 400;
        line-height: normal;
      }
    }

    .severity-chart {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 4px;
      flex: 1 0 0;

      .severity-item {
        display: flex;
        justify-content: flex-end;
        align-items: center;
        gap: 12px;
        align-self: stretch;

        .severity-item-name {
          display: flex;
          width: 80px;
          align-items: center;
          gap: 12px;
          align-self: stretch;
        }

        .severity-item-value {
          display: flex;
          width: 45px;
          justify-content: flex-end;
          align-items: center;
          gap: 12px;
          align-self: stretch;
        }
      }
    }
  }
</style>